# Reverse-2D-Number-Lookup-for-Headers-Excel-Macro
This Excel macro identifies the first nearest numerical match to an input value within a 2D matrix, range, or array. It returns key information: input value, closest match, row/column indexes, and headers to columns to the right of the input matrix. ChatGPT 3.5 was used to assist in generating this code. If there are multiple closest matches then will return topmost, then leftmost match.

Download FindNearestValue.bas and import by Developer > Visual Basic > File > Import, then run macro or create a module and copy and paste the code below the stated line.


![image](https://github.com/ltd033/Reverse-2D-Number-Lookup-for-Headers-Excel-Macro/blob/main/img/assign%20macro%20to%20shape.png)


Here is a simple multiplication table example. When selecting the matrix do not include the headers, only the output matrix or range of data.

[![image](https://github.com/ltd033/Reverse-2D-Number-Lookup-for-Headers-Excel-Macro/blob/main/img/mutliplication%20table%20example.png)

Here is an example showing how to get the resistor values for an input gain value in a non-inverting OPAMP amplifier

![image](https://github.com/ltd033/Reverse-2D-Number-Lookup-for-Headers-Excel-Macro/blob/main/img/non-inverting%20gain%20example.png)
